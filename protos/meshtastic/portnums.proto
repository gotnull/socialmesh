syntax = "proto3";

package meshtastic;

option java_package = "com.geeksville.mesh";
option java_outer_classname = "Portnums";
option optimize_for = LITE_RUNTIME;

/*
 * Packet sent to/from the radio for configuration and data
 * Field numbers match official Meshtastic protobufs:
 * https://github.com/meshtastic/protobufs/blob/master/meshtastic/mesh.proto
 */

import "meshtastic/mesh.proto";

// Packets sent to the radio
message ToRadio {
  oneof payload_variant {
    // Send this packet on the mesh
    MeshPacket packet = 1;
    
    // Phone wants radio to send full node db to the phone.
    // The integer you write into this field will be reported back in the
    // config_complete_id response - allows clients to never be confused by
    // a stale old partially sent config.
    uint32 want_config_id = 3;
    
    // Tell API server we are disconnecting now.
    bool disconnect = 4;
  }
}

// Packets received from radio
message FromRadio {
  // Packet ID for tracking
  uint32 id = 1;
  
  oneof payload_variant {
    // Received mesh packet
    MeshPacket packet = 2;
    
    // My node info - tells the phone what our node number is
    MyNodeInfo my_info = 3;
    
    // One packet is sent for each node in the on radio DB
    NodeInfo node_info = 4;
    
    // Sent as true once the device has finished sending all of the
    // responses to want_config - contains the config_id sent in wantConfigId
    uint32 config_complete_id = 7;
    
    // One packet is sent for each channel
    Channel channel = 10;
  }
}
